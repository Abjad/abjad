<h1>Real world examples for the impatient</h1>

<subsection>Rhythms: slicing and dicing <a href="#footnote_1">*</a>
<p>This example demonstrates how you can compose a sequence of notes with arbitrary durations outside a metric hierarchy (e.g. Measures) and then slice and dice the notes to have them fit a metric overlay added a posteriori.</p>

<p>Let us first define a set of durations from prime numbers:</p>
 
<abjad>
   abjad> durations = [5, 7, 2, 11, 13, 5, 13, 3]
   abjad> durations = zip(durations, [16] * len(durations))
   abjad> durations
   [(5, 16), (7, 16), (2, 16), (11, 16), (13, 16), (5, 16), (13, 16), (3, 16)]
</abjad>

<p>Let us now create a list of notes from these durations.</p> 

<abjad>
   hide> durations = [5, 7, 2, 11, 13, 5, 13, 3]
   hide> durations = zip(durations, [16] * len(durations))
   abjad> from abjad.tools import construct
   abjad> notes = construct.notes(0, durations)
   abjad> notes
   [Note(c', 4), Note(c', 16), Note(c', 8.), Note(c', 4), Note(c', 8), 
   Note(c', 8), Note(c', 2), Note(c', 16), Note(c', 8.), Note(c', 4), 
   Note(c', 4), Note(c', 8), Note(c', 8), Note(c', 8.), Note(c', 16), 
   Note(c', 4), Note(c', 2), Note(c', 8.)]
</abjad>

<p>Let us now put these notes inside a <RhythmicSketchStaff>.</p> 

<abjad>
   hide> durations = [5, 7, 2, 11, 13, 5, 13, 3]
   hide> durations = zip(durations, [16] * len(durations))
   hide> from abjad.tools import construct
   hide> notes = construct.notes(0, durations)
   abjad> staff = RhythmicSketchStaff(notes)
   hide> staff.formatter.opening.append(r'\set Score.proportionalNotationDuration = #(ly:make-moment 1 10)')
   abjad> show(staff)
</abjad>

<p>As this will become part of a piece for ensemble to be conducted, we would like all the parts to have a common metric (measure) structure. We now apply a <code>MetricGrid</code> spanner with the desired metric sequence to our staff.</p> 

<abjad>
   hide> durations = [5, 7, 2, 11, 13, 5, 13, 3]
   hide> durations = zip(durations, [16] * len(durations))
   hide> from abjad.tools import construct
   hide> notes = construct.notes(0, durations)
   hide> staff = RhythmicSketchStaff(notes)
   hide> staff.formatter.opening.append(r'\set Score.proportionalNotationDuration = #(ly:make-moment 1 10)')
   abjad> MetricGrid(staff, [(4, 4), (4, 4), (4, 4), (11, 16)])
   abjad> staff.meter.clear( )
   abjad> staff.barline.clear( )
   abjad> show(staff)
</abjad>

<p>Notice how some notes <b>span</b> more than one measure (i.e. they extend over the bar lines). This is a good thing because it shows that note durations and meter are treated independently. It also shows the flexibility and exactness of LilyPond's internal rhythmic model. We may not want these spanning notes in our final score, however. We may also want to show each beat by splitting notes every quarter or every half note duration. To do this we will slice the music to a second sequence of meters.</p>

<abjad>
   hide> durations = [5, 7, 2, 11, 13, 5, 13, 3]
   hide> durations = zip(durations, [16] * len(durations))
   hide> from abjad.tools import construct
   hide> notes = construct.notes(0, durations)
   hide> staff = RhythmicStaff(notes)
   hide> staff.formatter.opening.append(r'\set Score.proportionalNotationDuration = #(ly:make-moment 2 21)')
   hide> MetricGrid(staff, [(4, 4), (4, 4), (4, 4), (11, 16)])
   abjad> meters = [(1, 4)] * 4 + [(2, 4)] + [(1, 4)] * 6 + [(2, 4)] + [(3, 16)]
   abjad> metric_slice(staff, meters)
   abjad> show(staff)
</abjad>

<p>And this gives us our final score. </p>

<p><a name="footnote_1">*</a><small>This example reconstructs the first few measures of Stephen Lehman's <i>Rai</i> following the composer's own process: "I basically created a duration row, and then applied a meter to it after the fact. Then, once I started changing the distribution of prime number values over the course of the piece, I tried to make them fit in the same time span." </small> </p>
</subsection>

