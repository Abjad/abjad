Abjad build checklist:

 1. Open docs/chapters/start_here/versions/index.rst.
    Run "svn log --limit 30 | less" (or 40 or whatever) and read output.
    Or run "svn log --revision 4083:4977" and read output in chronological order.
    Edit docs/chapter/start_here/versions/indext.rst as appropriate.
    List new features and functionality.
    Highlight significant new functionality with a musical example.
    Begin entries with an active verb in the simple past.
    Order entries by leading verb: all adds together, all extensions together, etc.

 2. Commit.

 3. Edit cfg/cfg.py and increment 'abjad_version_number'.

 4. Edit tools/configurationtools/get_abjad_version_string.py and change the
    version number string given in the docstring.

 5. Edit docs/conf.py and increment 'version' and 'release'.

 6. Run abj-rmpycs. Then run py.test.
    If any tests break, fix and repeat this step.

 7. Change to abjad/tools and run the following three scripts:
    replace-abjad-prompts-with-python-prompts
    run-doctest-on-all-modules-in-tree
    replace-python-prompts-with-abjad-prompts
    If any tests break, fix and go back to (6.)

 8. Change to abjad/docs and run 'make clean'.
    (This step is important. Failing to 'make clean' before building
    the docs can cause the doc tarball made below in (22.)
    to exceed 10 megs. PyPI rejects doc tarballs greater than 10 megs.)

 9. Run make-abjad-api. If any errors occur, fix and go back to (6.)

10. Run 'make latex'. If any errors occur, fix and go back to (6.)

11. Change to docs/_build/latex and run 'make all-pdf'.
    If any errors occur, fix and go back to (6.)
    Open the docs/_build/latex/Abjad.pdf file that results.
    Click around some to make sure everything looks OK.

12. Copy docs/_build/latex/Abjad.pdf to docs/pdf/Abjad-x-y.pdf.
    Do this with 'cp' and not with 'svn cp'.

13. Add docs/pdf/Abajd-x-y.pdf to svn.

14. Remove docs/pdf/Abjad-x-(y-1).pdf from svn.

15. Change to abjad/trunk.

16. Edit setup.py and increment the 'version' string found there.

17. Run "svn info"
    Note the current revision of the working copy from which you are building.
    Open docs/chapters/start_here/versions/index.rst again.
    Check the build revision indicated there.
    Make sure the build revision equals current revision + 1.

18. Commit.

19. Run 'python setup.py sdist'.
    If any errors occur, fix and go back to (6.)

20. Run 'python setup.py register sdist upload'
    Follow the login instructions provided by PyPI.
    (Important. There is a bug in setup.py identified on the Internet.
    After you first register with PyPI you must view ~/.pypirc
    and change the line '[pypi]' to '[server-login]'. If you do
    not do this then this step will fail.)
    (Also important. It appears that this bug is fixed under Python 2.7.
    If you build under Python 2.7 leave the line '[pypi]' as is.
    Do not change this line to '[server-login]'.)
    You must have Abjad package owner credentials for this step to work.
    If you need Abjad package owner credentials, talk to Trevor or Victor.
    PyPI will respond with "Server response (200): OK".

21. Remove 'dist' and 'Abjad-egginfo-x.y'.
    The directories are no longer needed after upload to PyPI.
    The directories should not be checked into the Abjad repository.

22. Change to docs/_build/html and archive all 9 or 10 files and subdirectories therein.
    You must create a single archive of all 9 or 10 files.
    Through the Finder on the Mac you can shift-click all 9 or 10 files,
    then control-click the selected files and choose "Compress 9 items"
    from the context menu that appears.
    (Note that archiving just the docs/_build/html folder will not work.)
    Name the archive Archive.zip.
    Check the size of the archive.
    The archive must be less than 10 megs.

23. Log in to The PyPI website at pypi.python.org with Abjad owner credentials.
    Click on the Abjad link to edit PyPI's information about the package.

24. At the bottom of the "Package 'Abjad' Editing" page, click on "Choose file"
    and select docs/_build/html/Archive.zip. Then click on "Upload Documentation".
    PyPI will redirect to http://packages.python.org/Abjad/ and the newest version
    of the docs will appear. If it doesn't, debug and fix what went wrong.

25. Click your browser's "back" button to return to the "Package 'Abjad' Editing" page.
    Then click on the "edit" link to the left of the entry for the new x.y version.
    This will take you to the "Submitting package information" page.

26. Manually restore the diacritics in "Víctor Adán" and "Trevor Bača" in the "Author" field.
    (This is necessary because there's a bug in setup.py that fails on UNICODE metadata.
    So UNICODE characters must be added back in by hand on this page of the PyPI website
    rather than being more conveniently read from abjad/trunk/setup.py.)
    ("Josiah Oberholtzer" transmits fine here and doesn't have to be tweaked.)

27. Manually restore the spaces after each of the keyword phrases in
    "music composition, music notation, formalized score control, lilypond"
    in the "Keywords" field. (Again, setup.py mangles these on upload to PyPI.)

28. Click the "Add information" button at the bottom of the page to confirm.
    All PyPI editing and uploading is now complete.

29. Click around PyPI to make sure everything looks correct.
    Then leave PyPI.
    
30. Return to your Abjad sources and remove docs/_build/html/Archive.zip.
    The archive should not be checked in to the Abjad repository.

31. Author release announcement and mail to abjad-user@googlegroups.com.
    Release announcement should recapitulate version history.
    
[2011-08-21, rev. 2011-08-30, 2011-09-12, 2011-09-22, 2012-01-29]
