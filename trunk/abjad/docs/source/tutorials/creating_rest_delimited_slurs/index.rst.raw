Creating rest-delimited slurs
=============================

Take a look at the slurs in the following example and notice that 
there is a pattern to how they arranged.

<abjad>[hide=true]
string = r"\times 2/3 { c'4 d' r } r8 e'4 <fs' a' c''>8 ~ q4 \times 4/5 { r16 g' r b' d'' } df'4 c' ~ c'1"
staff = Staff(string)
leaves = leaftools.iterate_leaves_forward_in_expr(staff)
for group in componenttools.yield_groups_of_mixed_klasses_in_sequence(leaves, (Note, Chord)):
    if 1 < len(group):
        slur = spannertools.SlurSpanner(group)

show(staff)
</abjad>

The pattern?  Slurs in the example span groups of notes and chords separated by rests.

Abjad makes it easy to create such rest-delimited slurs in a structured way.

Let's start with the notes, rests and chords like this:

<abjad>
string = r"\times 2/3 { c'4 d' r } r8 e'4 <fs' a' c''>8 ~ q4 \times 4/5 { r16 g' r b' d'' } df'4 c' ~ c'1"
staff = Staff(string)
show(staff)
</abjad>

Next we'll group notes and chords together with one of the functions
available in the ``componenttools`` package, and add slur spanners inside
our loop:

<abjad>
leaves = leaftools.iterate_leaves_forward_in_expr(staff)
for group in componenttools.yield_groups_of_mixed_klasses_in_sequence(leaves, (Note, Chord)):
    spannertools.SlurSpanner(group)

</abjad>

And now we can take a look at the result:

<abjad>
show(staff)
</abjad>

Notice now that there's a little problem with the notation we just created.

Four SlurSpanners were generated, but only three slurs are shown.

Why?  LilyPond ignores slur terminators attached to the same note as the slur begins on.

Let's rewrite our example to prevent that from happening:

<abjad>
staff = Staff(string)
leaves = leaftools.iterate_leaves_forward_in_expr(staff)
klasses = (Note, Chord)
for group in componenttools.yield_groups_of_mixed_klasses_in_sequence(leaves, klasses):
    if 1 < len(group):
        spannertools.SlurSpanner(group)
</abjad>

And now the corrected result:

<abjad>
show(staff)
</abjad>
